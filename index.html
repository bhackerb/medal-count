<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Medal Tracker ‚Äî Milano Cortina 2026</title>
  <meta name="description" content="Live Winter Olympics medal count with data narratives, per-capita rankings, and more." />
  <meta property="og:title" content="Medal Tracker ‚Äî Milano Cortina 2026" />
  <meta property="og:description" content="The Olympics medal tracker that tells the real story. Per capita, gold rate, GDP-adjusted, and more." />
  <meta property="og:type" content="website" />
  <meta name="theme-color" content="#0a0a1a" />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Oswald:wght@400;500;600;700&family=Source+Serif+4:ital,wght@0,400;0,600;1,400&family=JetBrains+Mono:wght@400;500;700&display=swap" rel="stylesheet" />
  <style>
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
    html { scroll-behavior: smooth; }
    body {
      background: #0a0a1a;
      color: #e0e0e0;
      font-family: 'Source Serif 4', Georgia, serif;
      min-height: 100vh;
      overflow-x: hidden;
    }
    ::-webkit-scrollbar { width: 6px; }
    ::-webkit-scrollbar-track { background: transparent; }
    ::-webkit-scrollbar-thumb { background: rgba(255,215,0,0.2); border-radius: 3px; }
    #root { position: relative; z-index: 1; }

    .bg-glow {
      position: fixed; inset: 0; opacity: 0.04; z-index: 0; pointer-events: none;
      background: radial-gradient(ellipse at 20% 50%, #FFD700 0%, transparent 50%),
                  radial-gradient(ellipse at 80% 20%, #448AFF 0%, transparent 50%),
                  radial-gradient(ellipse at 50% 80%, #FF6D00 0%, transparent 50%);
    }

    @keyframes shimmer {
      0% { background-position: 0% center; }
      100% { background-position: 200% center; }
    }
    @keyframes slideIn {
      from { opacity: 0; transform: translateX(-20px); }
      to { opacity: 1; transform: translateX(0); }
    }
    @keyframes fadeUp {
      from { opacity: 0; transform: translateY(16px); }
      to { opacity: 1; transform: translateY(0); }
    }
    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.5; }
    }
    @keyframes countUp {
      from { opacity: 0; transform: translateY(8px); }
      to { opacity: 1; transform: translateY(0); }
    }
  </style>
</head>
<body>
  <div class="bg-glow"></div>
  <div id="root"></div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.9/babel.min.js"></script>

  <script type="text/babel">
    const { useState, useEffect, useMemo, useCallback, useRef } = React;

    // ‚îÄ‚îÄ‚îÄ CONFIG ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    const REFRESH_INTERVAL = 2 * 60 * 1000; // 2 minutes
    const TOTAL_EVENTS = 116;

    // ‚îÄ‚îÄ‚îÄ HELPERS ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    const total = (c) => c.gold + c.silver + c.bronze;
    const perCapita = (c) => (total(c) / c.population) * 10;
    const goldPerCapita = (c) => (c.gold / c.population) * 10;
    const efficiency = (c) => (c.gold / Math.max(total(c), 1)) * 100;
    const medalsPerBillion = (c) => (total(c) / c.gdp) * 1000;

    const SORT_MODES = {
      traditional: { label: "Official", desc: "IOC standard: gold ‚Üí silver ‚Üí bronze", fn: (a, b) => b.gold - a.gold || b.silver - a.silver || b.bronze - a.bronze },
      total: { label: "Total", desc: "Raw medal count", fn: (a, b) => total(b) - total(a) || b.gold - a.gold },
      perCapita: { label: "Per Capita", desc: "Medals per 10M citizens", fn: (a, b) => perCapita(b) - perCapita(a) },
      goldPerCapita: { label: "Gold/Capita", desc: "Golds per 10M citizens", fn: (a, b) => goldPerCapita(b) - goldPerCapita(a) },
      efficiency: { label: "Gold Rate", desc: "% of medals that are gold", fn: (a, b) => efficiency(b) - efficiency(a) },
      gdp: { label: "Per GDP", desc: "Medals per $1B GDP", fn: (a, b) => medalsPerBillion(b) - medalsPerBillion(a) },
    };

    // ‚îÄ‚îÄ‚îÄ NARRATIVES ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    function generateNarratives(data) {
      if (!data || data.length === 0) return [];
      const sorted = [...data].sort(SORT_MODES.traditional.fn);
      const byPC = [...data].sort(SORT_MODES.perCapita.fn);
      const byEff = [...data].filter(c => total(c) >= 3).sort(SORT_MODES.efficiency.fn);
      const totalMedals = data.reduce((s, c) => s + total(c), 0);
      const totalGold = data.reduce((s, c) => s + c.gold, 0);
      const stories = [];

      const leader = sorted[0];
      if (leader) stories.push({
        icon: "üëë", color: "#FFD700",
        title: `${leader.flag} ${leader.name} Leads the Pack`,
        text: `With ${leader.gold} golds and ${total(leader)} total medals, ${leader.name} sits atop the standings ‚Äî claiming ${((leader.gold / Math.max(totalGold, 1)) * 100).toFixed(0)}% of all gold medals awarded.`,
      });

      const host = data.find(c => c.isHost);
      if (host && total(host) > 0) stories.push({
        icon: "üè†", color: "#00C853",
        title: `Host Nation ${host.flag} Thriving at Home`,
        text: `Italy has ${total(host)} medals ‚Äî the most by total count. With ${host.bronze} bronzes, ${host.silver} silvers, and ${host.gold} golds, the home crowd advantage is paying off.`,
      });

      const pcKing = byPC[0];
      if (pcKing) {
        const usRate = byPC.find(c => c.code === "USA");
        const ratio = usRate ? (perCapita(pcKing) / perCapita(usRate)).toFixed(0) : "many";
        stories.push({
          icon: "üìä", color: "#448AFF",
          title: `Size Doesn't Matter: ${pcKing.flag} ${pcKing.name}`,
          text: `Per capita, ${pcKing.name} (pop. ${pcKing.population}M) has ${perCapita(pcKing).toFixed(1)} medals per 10M people ‚Äî ${ratio}x the US rate. The real Olympic powerhouse.`,
        });
      }

      if (byEff.length > 0) {
        const eff = byEff[0];
        stories.push({
          icon: "üéØ", color: "#FF6D00",
          title: `${eff.flag} ${eff.name}: When They Medal, They Medal Gold`,
          text: `${efficiency(eff).toFixed(0)}% of ${eff.name}'s ${total(eff)} medals are gold ‚Äî the highest conversion rate among countries with 3+ medals.`,
        });
      }

      const surprises = data.filter(c => total(c) > 0 && c.historicalWinterTotal > 0 && c.historicalWinterTotal < 30)
        .sort((a, b) => (total(b) / b.historicalWinterTotal) - (total(a) / a.historicalWinterTotal));
      if (surprises.length > 0) {
        const s = surprises[0];
        stories.push({
          icon: "üöÄ", color: "#E040FB",
          title: `${s.flag} ${s.name} Is Having Their Best Games Ever`,
          text: `${total(s)} medals already puts them at ${((total(s) / s.historicalWinterTotal) * 100).toFixed(0)}% of their all-time Winter Olympics total of ${s.historicalWinterTotal}. History in the making.`,
        });
      }

      const canada = data.find(c => c.code === "CAN");
      if (canada && canada.gold === 0 && total(canada) > 0) stories.push({
        icon: "üíî", color: "#FF1744",
        title: `${canada.flag} Canada: ${total(canada)} Medals, Zero Gold`,
        text: `The winter sports powerhouse has ${canada.silver} silvers and ${canada.bronze} bronzes but can't find gold. NHL hockey starts soon ‚Äî that could change everything.`,
      });

      const completedEvents = Math.round(totalMedals / 3); // rough estimate
      stories.push({
        icon: "‚è±Ô∏è", color: "#78909C",
        title: `${totalMedals} Medals Across ${data.filter(c => total(c) > 0).length} Nations`,
        text: `~${((completedEvents / TOTAL_EVENTS) * 100).toFixed(0)}% of events complete. ${TOTAL_EVENTS - completedEvents} remain ‚Äî including hockey, which could reshape the entire standings.`,
      });

      return stories;
    }

    // ‚îÄ‚îÄ‚îÄ COMPONENTS ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

    function LiveIndicator({ lastUpdated, isRefreshing }) {
      const [timeAgo, setTimeAgo] = useState("");
      useEffect(() => {
        const update = () => {
          if (!lastUpdated) return;
          const diff = Math.floor((Date.now() - new Date(lastUpdated).getTime()) / 1000);
          if (diff < 60) setTimeAgo(`${diff}s ago`);
          else if (diff < 3600) setTimeAgo(`${Math.floor(diff / 60)}m ago`);
          else setTimeAgo(`${Math.floor(diff / 3600)}h ago`);
        };
        update();
        const i = setInterval(update, 10000);
        return () => clearInterval(i);
      }, [lastUpdated]);

      return (
        <div style={{
          display: "flex", alignItems: "center", gap: "6px",
          fontFamily: "'JetBrains Mono', monospace", fontSize: "10px", color: "#555",
          justifyContent: "center", marginTop: "6px",
        }}>
          <span style={{
            width: "6px", height: "6px", borderRadius: "50%",
            background: isRefreshing ? "#FFA000" : "#00C853",
            animation: isRefreshing ? "pulse 1s infinite" : "none",
            boxShadow: isRefreshing ? "0 0 8px #FFA000" : "0 0 8px #00C853",
          }} />
          {isRefreshing ? "UPDATING..." : `LIVE ¬∑ UPDATED ${timeAgo}`}
          <span style={{ color: "#333" }}> ¬∑ AUTO-REFRESH 2MIN</span>
        </div>
      );
    }

    function AnimatedNumber({ value, suffix = "" }) {
      const [display, setDisplay] = useState(0);
      const prevValue = useRef(value);
      useEffect(() => {
        const start = prevValue.current;
        const end = value;
        prevValue.current = value;
        if (start === end) { setDisplay(end); return; }
        const duration = 800;
        const startTime = Date.now();
        const tick = () => {
          const p = Math.min((Date.now() - startTime) / duration, 1);
          const eased = 1 - Math.pow(1 - p, 3);
          setDisplay(Math.round(start + (end - start) * eased));
          if (p < 1) requestAnimationFrame(tick);
        };
        tick();
      }, [value]);
      return React.createElement("span", null, display, suffix);
    }

    function BigStat({ value, label, color = "#FFD700" }) {
      return (
        <div style={{ textAlign: "center", minWidth: "80px" }}>
          <div style={{
            fontFamily: "'Oswald', sans-serif", fontSize: "clamp(32px, 6vw, 48px)",
            fontWeight: 700, color, lineHeight: 1, textShadow: `0 0 40px ${color}33`,
          }}>
            <AnimatedNumber value={value} />
          </div>
          <div style={{
            fontFamily: "'JetBrains Mono', monospace", fontSize: "9px",
            color: "#555", textTransform: "uppercase", letterSpacing: "1.5px", marginTop: "4px",
          }}>{label}</div>
        </div>
      );
    }

    function MedalBar({ country, maxTotal, rank, sortMode }) {
      const t = total(country);
      const goldW = (country.gold / Math.max(maxTotal, 1)) * 100;
      const silverW = (country.silver / Math.max(maxTotal, 1)) * 100;
      const bronzeW = (country.bronze / Math.max(maxTotal, 1)) * 100;

      let stat = "";
      if (sortMode === "perCapita") stat = `${perCapita(country).toFixed(1)}/10M`;
      else if (sortMode === "goldPerCapita") stat = `${goldPerCapita(country).toFixed(1)}/10M`;
      else if (sortMode === "efficiency") stat = `${efficiency(country).toFixed(0)}% gold`;
      else if (sortMode === "gdp") stat = `${medalsPerBillion(country).toFixed(2)}/$1B`;

      return (
        <div style={{
          display: "grid",
          gridTemplateColumns: "28px 36px minmax(70px, 130px) 1fr auto 44px",
          alignItems: "center", gap: "8px", padding: "7px 10px", borderRadius: "8px",
          background: rank <= 3 ? `rgba(255,215,0,${0.08 - rank * 0.02})` : "transparent",
          animation: `slideIn 0.4s ease ${rank * 0.04}s both`,
        }}>
          <span style={{
            fontFamily: "'Oswald', sans-serif",
            fontSize: rank <= 3 ? "17px" : "13px", fontWeight: 700, textAlign: "center",
            color: rank === 1 ? "#FFD700" : rank === 2 ? "#C0C0C0" : rank === 3 ? "#CD7F32" : "#555",
          }}>{rank}</span>

          <span style={{ fontSize: "24px", lineHeight: 1 }}>{country.flag}</span>

          <div>
            <div style={{
              fontFamily: "'Oswald', sans-serif", fontWeight: 600,
              fontSize: "13px", color: "#e0e0e0", letterSpacing: "0.5px",
            }}>
              {country.code}
              {country.isHost && <span style={{ color: "#FFD700", marginLeft: "4px", fontSize: "9px" }}>‚òÖ</span>}
            </div>
            {stat && <div style={{
              fontFamily: "'JetBrains Mono', monospace", fontSize: "10px", color: "#666",
            }}>{stat}</div>}
          </div>

          <div style={{
            display: "flex", height: "20px", borderRadius: "3px",
            overflow: "hidden", background: "rgba(255,255,255,0.02)",
          }}>
            {country.gold > 0 && <div style={{
              width: `${goldW}%`, minWidth: country.gold > 0 ? "3px" : 0,
              background: "linear-gradient(135deg, #FFD700, #FFA000)",
              transition: "width 0.6s cubic-bezier(0.4,0,0.2,1)",
            }} />}
            {country.silver > 0 && <div style={{
              width: `${silverW}%`, minWidth: country.silver > 0 ? "3px" : 0,
              background: "linear-gradient(135deg, #E0E0E0, #9E9E9E)",
              transition: "width 0.6s cubic-bezier(0.4,0,0.2,1)",
            }} />}
            {country.bronze > 0 && <div style={{
              width: `${bronzeW}%`, minWidth: country.bronze > 0 ? "3px" : 0,
              background: "linear-gradient(135deg, #CD7F32, #8B4513)",
              transition: "width 0.6s cubic-bezier(0.4,0,0.2,1)",
            }} />}
          </div>

          <div style={{ display: "flex", gap: "3px" }}>
            {[
              { v: country.gold, bg: "linear-gradient(135deg,#FFD700,#FFA000)", c: "#1a1a2e" },
              { v: country.silver, bg: "linear-gradient(135deg,#E0E0E0,#9E9E9E)", c: "#1a1a2e" },
              { v: country.bronze, bg: "linear-gradient(135deg,#CD7F32,#8B4513)", c: "#fff" },
            ].map((m, i) => (
              <span key={i} style={{
                background: m.bg, color: m.c, fontWeight: 800, borderRadius: "4px",
                padding: "1px 5px", fontSize: "11px", minWidth: "20px", textAlign: "center",
                fontFamily: "'JetBrains Mono', monospace",
              }}>{m.v}</span>
            ))}
          </div>

          <span style={{
            fontFamily: "'Oswald', sans-serif", fontWeight: 700,
            fontSize: "17px", color: "#fff", textAlign: "right",
          }}>{t}</span>
        </div>
      );
    }

    function NarrativeCard({ story, index }) {
      return (
        <div style={{
          background: "rgba(255,255,255,0.03)",
          border: `1px solid ${story.color}22`,
          borderLeft: `3px solid ${story.color}`,
          borderRadius: "10px", padding: "16px",
          animation: `fadeUp 0.5s ease ${index * 0.08}s both`,
          transition: "transform 0.2s ease",
        }}
        onMouseEnter={e => e.currentTarget.style.transform = "translateY(-2px)"}
        onMouseLeave={e => e.currentTarget.style.transform = "translateY(0)"}
        >
          <div style={{ display: "flex", gap: "10px", alignItems: "flex-start" }}>
            <span style={{ fontSize: "22px", lineHeight: 1, flexShrink: 0 }}>{story.icon}</span>
            <div>
              <h3 style={{
                fontFamily: "'Oswald', sans-serif", fontSize: "14px",
                fontWeight: 600, color: story.color, margin: "0 0 4px",
              }}>{story.title}</h3>
              <p style={{
                fontFamily: "'Source Serif 4', Georgia, serif",
                fontSize: "13px", color: "#999", margin: 0, lineHeight: 1.5,
              }}>{story.text}</p>
            </div>
          </div>
        </div>
      );
    }

    function ContinentBreakdown({ data }) {
      const continents = {};
      data.forEach(c => {
        if (total(c) === 0) return;
        if (!continents[c.continent]) continents[c.continent] = { gold: 0, silver: 0, bronze: 0, n: 0 };
        continents[c.continent].gold += c.gold;
        continents[c.continent].silver += c.silver;
        continents[c.continent].bronze += c.bronze;
        continents[c.continent].n++;
      });
      const emoji = { Europe: "üåç", Americas: "üåé", Asia: "üåè", Oceania: "üèùÔ∏è" };
      const sorted = Object.entries(continents).sort((a, b) =>
        (b[1].gold + b[1].silver + b[1].bronze) - (a[1].gold + a[1].silver + a[1].bronze));

      return (
        <div style={{ display: "flex", flexWrap: "wrap", gap: "10px", justifyContent: "center" }}>
          {sorted.map(([name, s]) => (
            <div key={name} style={{
              background: "rgba(255,255,255,0.03)", border: "1px solid rgba(255,255,255,0.06)",
              borderRadius: "10px", padding: "14px 18px", minWidth: "130px", textAlign: "center",
            }}>
              <div style={{ fontSize: "18px" }}>{emoji[name] || "üåê"}</div>
              <div style={{
                fontFamily: "'Oswald', sans-serif", fontSize: "13px",
                fontWeight: 600, color: "#e0e0e0", margin: "4px 0",
              }}>{name}</div>
              <div style={{ display: "flex", gap: "3px", justifyContent: "center" }}>
                {[
                  { v: s.gold, bg: "linear-gradient(135deg,#FFD700,#FFA000)", c: "#1a1a2e" },
                  { v: s.silver, bg: "linear-gradient(135deg,#E0E0E0,#9E9E9E)", c: "#1a1a2e" },
                  { v: s.bronze, bg: "linear-gradient(135deg,#CD7F32,#8B4513)", c: "#fff" },
                ].map((m, i) => (
                  <span key={i} style={{
                    background: m.bg, color: m.c, fontWeight: 800, borderRadius: "4px",
                    padding: "1px 6px", fontSize: "11px", fontFamily: "'JetBrains Mono', monospace",
                  }}>{m.v}</span>
                ))}
              </div>
              <div style={{
                fontFamily: "'JetBrains Mono', monospace", fontSize: "9px", color: "#555", marginTop: "6px",
              }}>{s.n} nations</div>
            </div>
          ))}
        </div>
      );
    }

    // ‚îÄ‚îÄ‚îÄ MAIN APP ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    function App() {
      const [data, setData] = useState([]);
      const [lastUpdated, setLastUpdated] = useState(null);
      const [source, setSource] = useState(null);
      const [sortMode, setSortMode] = useState("traditional");
      const [showStories, setShowStories] = useState(true);
      const [isRefreshing, setIsRefreshing] = useState(false);
      const [error, setError] = useState(null);

      const fetchData = useCallback(async () => {
        setIsRefreshing(true);
        try {
          const res = await fetch("/api/medals");
          const json = await res.json();
          if (json.medals && json.medals.length > 0) {
            setData(json.medals);
            setLastUpdated(json.lastUpdated);
            setSource(json.source);
            setError(null);
          }
        } catch (err) {
          console.error("Fetch failed:", err);
          setError("Failed to fetch data");
        } finally {
          setIsRefreshing(false);
        }
      }, []);

      // Initial fetch + auto-refresh
      useEffect(() => {
        fetchData();
        const interval = setInterval(fetchData, REFRESH_INTERVAL);
        return () => clearInterval(interval);
      }, [fetchData]);

      const withMedals = useMemo(() => data.filter(c => total(c) > 0), [data]);
      const sorted = useMemo(() => [...withMedals].sort(SORT_MODES[sortMode].fn), [withMedals, sortMode]);
      const maxTotal = useMemo(() => Math.max(...sorted.map(total), 1), [sorted]);
      const narratives = useMemo(() => generateNarratives(data), [data]);

      const totalMedals = data.reduce((s, c) => s + total(c), 0);
      const totalGold = data.reduce((s, c) => s + c.gold, 0);
      const nationsWithMedals = withMedals.length;

      if (data.length === 0 && !error) {
        return (
          <div style={{ display: "flex", justifyContent: "center", alignItems: "center", minHeight: "100vh" }}>
            <div style={{
              fontFamily: "'Oswald', sans-serif", color: "#FFD700",
              fontSize: "18px", animation: "pulse 1.5s infinite",
            }}>Loading medal data...</div>
          </div>
        );
      }

      return (
        <div style={{ maxWidth: "900px", margin: "0 auto", padding: "32px 16px" }}>

          {/* Header */}
          <header style={{ textAlign: "center", marginBottom: "40px" }}>
            <div style={{
              fontFamily: "'JetBrains Mono', monospace", fontSize: "10px",
              color: "#FFD700", textTransform: "uppercase", letterSpacing: "4px", marginBottom: "10px",
            }}>‚ùÑÔ∏è WINTER OLYMPICS ‚ùÑÔ∏è</div>

            <h1 style={{
              fontFamily: "'Oswald', sans-serif", fontSize: "clamp(36px, 8vw, 64px)",
              fontWeight: 700, margin: 0, lineHeight: 0.95, letterSpacing: "-1px",
              background: "linear-gradient(135deg, #FFD700, #FFA000, #FFD700, #fff, #FFD700)",
              backgroundSize: "200% auto", WebkitBackgroundClip: "text",
              WebkitTextFillColor: "transparent", animation: "shimmer 3s linear infinite",
            }}>MEDAL TRACKER</h1>

            <div style={{
              fontFamily: "'Source Serif 4', Georgia, serif",
              fontSize: "15px", color: "#666", marginTop: "6px", fontStyle: "italic",
            }}>Milano Cortina 2026</div>

            <LiveIndicator lastUpdated={lastUpdated} isRefreshing={isRefreshing} />

            {/* Big stats */}
            <div style={{
              display: "flex", justifyContent: "center", gap: "clamp(20px, 5vw, 48px)",
              marginTop: "28px", flexWrap: "wrap",
            }}>
              <BigStat value={totalMedals} label="Medals" color="#FFD700" />
              <BigStat value={totalGold} label="Gold" color="#FFA000" />
              <BigStat value={nationsWithMedals} label="Nations" color="#448AFF" />
              <BigStat value={TOTAL_EVENTS} label="Events" color="#78909C" />
            </div>

            {/* Progress bar */}
            <div style={{
              margin: "20px auto 0", maxWidth: "500px", height: "3px",
              background: "rgba(255,255,255,0.04)", borderRadius: "2px", overflow: "hidden",
            }}>
              <div style={{
                width: `${Math.min((Math.round(totalMedals / 3) / TOTAL_EVENTS) * 100, 100)}%`,
                height: "100%",
                background: "linear-gradient(90deg, #FFD700, #FF6D00)",
                transition: "width 1s ease",
              }} />
            </div>
          </header>

          {/* Stories toggle */}
          <div style={{ display: "flex", justifyContent: "center", marginBottom: "20px", gap: "8px" }}>
            <button onClick={() => setShowStories(!showStories)} style={{
              fontFamily: "'Oswald', sans-serif", fontSize: "11px",
              letterSpacing: "1.5px", textTransform: "uppercase",
              background: showStories ? "rgba(255,215,0,0.1)" : "rgba(255,255,255,0.03)",
              border: `1px solid ${showStories ? "rgba(255,215,0,0.3)" : "rgba(255,255,255,0.08)"}`,
              color: showStories ? "#FFD700" : "#666", padding: "7px 18px",
              borderRadius: "18px", cursor: "pointer", transition: "all 0.2s",
            }}>üìñ {showStories ? "Stories" : "Show Stories"}</button>
          </div>

          {/* Narratives */}
          {showStories && (
            <div style={{
              display: "grid", gridTemplateColumns: "repeat(auto-fit, minmax(260px, 1fr))",
              gap: "10px", marginBottom: "36px",
            }}>
              {narratives.map((s, i) => <NarrativeCard key={i} story={s} index={i} />)}
            </div>
          )}

          {/* Sort buttons */}
          <div style={{
            display: "flex", flexWrap: "wrap", gap: "5px",
            justifyContent: "center", marginBottom: "16px",
          }}>
            {Object.entries(SORT_MODES).map(([key, mode]) => (
              <button key={key} onClick={() => setSortMode(key)} style={{
                fontFamily: "'JetBrains Mono', monospace", fontSize: "10px",
                background: sortMode === key ? "rgba(255,215,0,0.12)" : "rgba(255,255,255,0.02)",
                border: `1px solid ${sortMode === key ? "rgba(255,215,0,0.35)" : "rgba(255,255,255,0.05)"}`,
                color: sortMode === key ? "#FFD700" : "#666",
                padding: "5px 12px", borderRadius: "5px", cursor: "pointer", transition: "all 0.2s",
              }}>{mode.label}</button>
            ))}
          </div>
          <div style={{
            textAlign: "center", fontFamily: "'JetBrains Mono', monospace",
            fontSize: "9px", color: "#444", marginBottom: "10px",
          }}>{SORT_MODES[sortMode].desc}</div>

          {/* Medal Table */}
          <div style={{
            background: "rgba(255,255,255,0.015)", border: "1px solid rgba(255,255,255,0.05)",
            borderRadius: "14px", padding: "12px 6px", marginBottom: "36px",
          }}>
            {sorted.map((country, i) => (
              <MedalBar key={country.code} country={country} maxTotal={maxTotal} rank={i + 1} sortMode={sortMode} />
            ))}
          </div>

          {/* Continents */}
          <div style={{ marginBottom: "36px" }}>
            <h2 style={{
              fontFamily: "'Oswald', sans-serif", fontSize: "18px", fontWeight: 600,
              color: "#FFD700", textAlign: "center", marginBottom: "14px",
              letterSpacing: "2px", textTransform: "uppercase",
            }}>By Continent</h2>
            <ContinentBreakdown data={data} />
          </div>

          {/* Footer */}
          <footer style={{
            textAlign: "center", padding: "20px 0",
            borderTop: "1px solid rgba(255,255,255,0.04)",
          }}>
            <div style={{
              fontFamily: "'JetBrains Mono', monospace", fontSize: "9px",
              color: "#333", lineHeight: 2,
            }}>
              MEDAL TRACKER ¬∑ BUILT BY{" "}
              <a href="https://bhackerb.com" style={{ color: "#FFD700", textDecoration: "none" }}>BHACKERB</a>
              <br />DATA VIA IOC ¬∑ POP: WORLD BANK 2024 ¬∑ GDP: IMF 2024 ¬∑ NOT AFFILIATED WITH IOC
              <br />
              {source === "fallback" && <span style={{ color: "#FF6D00" }}>‚ö† USING CACHED DATA ‚Äî LIVE SCRAPE UNAVAILABLE</span>}
            </div>
          </footer>
        </div>
      );
    }

    ReactDOM.createRoot(document.getElementById("root")).render(React.createElement(App));
  </script>
</body>
</html>
